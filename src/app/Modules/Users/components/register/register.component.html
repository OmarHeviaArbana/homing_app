<section class="register">
  <div class="register__container">
    <h1 class="register__title">Formulario de registro</h1>
    <div *ngIf="loading$ | async" class="spinner-container">
      <mat-progress-spinner diameter="100" class="spinner" mode="indeterminate" color="primary">
      </mat-progress-spinner>
    </div>
    <div *ngIf="!(loading$ | async) || (loaded$ | async)">
      <form [formGroup]="registerFormUser" (ngSubmit)="register()" class="register__container-form">
        <mat-form-field appearance="fill">
          <mat-label>Nombre</mat-label>
          <input matInput type="text" [formControl]="name" required aria-label="Introduce tu nombre" />
          <mat-error *ngIf="name.invalid">{{getErrorNameMessage()}}</mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Apellidos</mat-label>
          <input matInput type="text" [formControl]="username" required aria-label="Introduce tus apellidos" />
          <mat-error *ngIf="username.invalid">{{getErrorUserNameMessage()}}</mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Email:</mat-label>
          <input matInput type="email" [formControl]="email" required aria-label="introduce tu email" />
          <mat-error *ngIf="email.invalid">{{getErrorEmailMessage()}}</mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Contraseña</mat-label>
          <input matInput type="password" [formControl]="password" required aria-label="Introduce una contraseña" />
          <mat-error *ngIf="password.invalid">{{getErrorPasswordMessage()}}</mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Indica el tipo de usuario:</mat-label>
          <mat-select [formControl]="role_id" required aria-label="Introduce la tipologia de usuario">
            <mat-option *ngFor="let rol of rolUserList" [value]="rol.id">
              {{rol.name}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </form>


     <form *ngIf="role_id.value == 3 || role_id.value == 4" [formGroup]="registerFormShelterBreeder" (ngSubmit)="register()" class="container-form">

        <h2>Datos adicionales</h2>

        <mat-form-field appearance="fill">
          <mat-label>Nombre del refugio</mat-label>
          <input matInput type="text" [formControl]="name" required aria-label="Introduce el nombre del refugio" />
          <mat-error *ngIf="name.invalid">{{getErrorNameMessage()}}</mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill" *ngIf="role_id.value == 3">
          <mat-label>CIF de refugio</mat-label>
          <input matInput type="text" [formControl]="cif" required aria-label="Introduce el CIF del refugio" />
          <mat-error *ngIf="cif.invalid">{{getErrorCifMessage()}}</mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill" *ngIf="role_id.value == 4">
          <mat-label>Núcleo zoológico</mat-label>
          <input matInput type="text" [formControl]="certification" required aria-label="Introduce el nucleo zoológico del criadero" />
          <mat-error *ngIf="certification.invalid">{{getErrorCertificationMessage()}}</mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill" *ngIf="role_id.value == 3">
          <mat-label>Email Refugio:</mat-label>
          <input matInput type="email" [formControl]="email_shelter" required aria-label="Introduce el email del refugio" />
          <mat-error *ngIf="email_shelter.invalid">{{getErrorEmailMessage()}}</mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill" *ngIf="role_id.value == 4">
          <mat-label>Email Criadero:</mat-label>
          <input matInput type="email" [formControl]="email_breeder" required aria-label="Introduce el email del criedero" />
          <mat-error *ngIf="email_breeder.invalid">{{getErrorEmailMessage()}}</mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Teléfono de contacto:</mat-label>
          <input matInput type="text" [formControl]="phone" required aria-label="Introduce un telédono de contacto" />
          <mat-error *ngIf="phone.invalid">{{getErrorPhoneMessage()}}</mat-error>
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Localidad</mat-label>
          <input matInput type="text" [formControl]="location" required aria-label="Introduce la localidad" />
          <mat-error *ngIf="location.invalid">{{getErrorLocationMessage()}}</mat-error>
        </mat-form-field>

        <input type="file" placeholder="Adjunta un Logotipo o Imágen representativo de tu actividad" accept="image/*" [formControl]="logo_url"  required />
       <mat-error *ngIf="logo_url.invalid">{{getErrorLocationMessage()}}</mat-error>

        <mat-form-field appearance="fill">
          <mat-label>Descripción</mat-label>
          <textarea matInput maxlength="300" placeholder="Haz una breve descripción de tu actividad" [formControl]="description" required aria-label="Introduce una descripción de tu actividad"></textarea>
           <mat-error *ngIf="description.invalid">{{getErrorDescriptionMessage()}}</mat-error>
        </mat-form-field>
      </form>

      <div class="register__actions">
        <app-button variant="primary" type="submit" [disabled]="!registerFormUser.valid || ( (role_id.value == 3 || role_id.value == 4) && !registerFormShelterBreeder.valid )">Registrarme</app-button>
        <app-button variant="outline">Cancelar</app-button>
      </div>
    </div>
  </div>
</section>
